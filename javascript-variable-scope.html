<!DOCTYPE html>
<html dir="rtl">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>JavaScript - תחומים ונהנים</title>
  <meta name="description" content="איפה המשתנים נשמרים ב- JavaScript ואיך ניתן לגשת אליהם? כל זאת ועוד במדריך זה, אשר יעסוק בחוקי ה- Scope בג׳אווהסקריפ.">

  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="/css/syntax.css">
  
  <link rel="stylesheet" href="http://fonts.googleapis.com/earlyaccess/opensanshebrew.css">

  <link rel="canonical" href="http://devhead.co.il/javascript-variable-scope">
  <link rel="alternate" type="application/rss+xml" title="ראש פיתוח" href="http://devhead.co.il/feed.xml">
  

	<meta property="og:type" content="article" />
	<meta property="og:title" content="JavaScript - תחומים ונהנים" />
  
  <meta property="og:description" content="איפה המשתנים נשמרים ב- JavaScript ואיך ניתן לגשת אליהם? כל זאת ועוד במדריך זה, אשר יעסוק בחוקי ה- Scope בג׳אווהסקריפ." />
  



  <meta property="og:site_name" content="ראש פיתוח" />







  <meta property="og:url" content="http://devhead.co.il/javascript-variable-scope" />



  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-18040964-6', 'auto');
    ga('send', 'pageview');
  </script>
</head>


  <body>
    <div class="site-container">

    <header class="site-header">
  <a href="/"><h1 class="site-logo">ראש פיתוח</h1></a>
  <nav class="site-links">
    <a href="/about" class="site-links__item">אודות</a>
  </nav>
</header>


    <div class="content">
      <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <time class="post__time" datetime="2016-03-16T00:00:00+02:00" itemprop="datePublished">error</time>
  <h2 class="post__title" itemprop="headline name">JavaScript - תחומים ונהנים</h2>
  
  <div itemprop="articleBody">
    <p>בכל שפת תכנות אנו רגילים לראות דפוס מסוים: היכולת לשמור ולגשת למשתנים.<br />
הדפוס הזה מעלה מספר שאלות - <strong>איפה המשתנים נשמרים? ואיך ניתן לגשת אליהם?</strong></p>

<p>על מנת לענות על שאלות אלו נצטרך רשימת חוקים לפיהם נדע כיצד לכתוב קוד בצורה נכונה ואפקטיבית. רשימת החוקים הזו נקבעת על ידי ה- Scope.</p>

<h3 id="scope">מה זה Scope?</h3>

<p>Scope הוא תחום בו משתנים (ופונקציות) מתקיימים. לכל משתנה יש תחום (Variable Scope), שנקבע על פי המקום בו הכרזנו על המשתנה.<br />
ב- JavaScript קיימים שני סוגי תחומים - <strong>תחום גלובלי</strong> (Global Scope) ו<strong>תחום מקומי</strong> (Local Scope).</p>

<h4 id="global-scope">Global Scope</h4>
<p>כאשר משתנה נוצר בתחום הגלובלי הוא הופך להיות משתנה גלובלי וזמין בכל מקום בקוד.</p>

<p>משתנים גלובליים משתייכים לאובייקט הגלובלי - <code class="highlighter-rouge">window</code> במידה והקוד רץ בדפדפן.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">"Hello!"</span><span class="p">;</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// Hello!</span></code></pre></figure>

<p>כל עוד משתנה לא הוגדר תחת פונקציה כלשהיא הוא יהיה שייך לתחום הגלובלי.</p>

<h4 id="local-scope">Local Scope</h4>
<p>בניגוד לתחום הגלובלי, כאשר משתנה נוצר בתחום מקומי הוא זמין לתחום זה בלבד, ולא מחוצה לו:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">// Global Scope</span>
<span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">print</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Local Scope</span>
  <span class="kd">var</span> <span class="nx">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">print</span><span class="p">();</span> <span class="c1">// 1 2</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span> <span class="c1">// ReferenceError: b is not defined</span></code></pre></figure>

<p>ב- JavaScript תחומים מקומיים נוצרים על ידי פונקציות בלבד. בערך.</p>

<aside class="post__note">
<p>
Block הוא קוד אשר עטוף בסוגריים מסולסלים, כמו בלולאות ומשפטי תנאי.
<br />
ב- JavaScript לא קיים Block Scope, ומשתנים אשר יוכרזו תחת בלוק יהיו שייכים לתחום אשר הבלוק נמצא תחתיו.
</p>
<figure>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">if</span> <span class="p">(</span> <span class="kc">true</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">"Hello!"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// Hello!</span></code></pre></figure>

<figcaption>המשתנה נוצר בתחום הגלובלי</figcaption>
</figure>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let">ES6 מציגה מילה חדשה</a>, <code>let</code>, אשר כן יוצרת Block Scope, כך שמשתנים הופכים מקומיים ל- Block בו הם הוכרזו.</p>


<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">if</span> <span class="p">(</span> <span class="kc">true</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="s2">"Hello!"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// ReferenceError: a is not defined</span></code></pre></figure>


<p>לא ארחיב מעבר לכך במדריך זה, אך חשוב לדעת שאופצייה זו קיימת.</p>
</aside>

<h4 id="nested-scopes">Nested Scopes</h4>

<p>מאחר שמשתנה זמין לתחום בו הוא נוצר, פונקציות שהוגדרו בתוך התחום יכולות גם הן לגשת למשתנה.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">outer</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kd">function</span> <span class="nx">inner</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">z</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>בקטע קוד זה ל- <code class="highlighter-rouge">inner</code> יש גישה לכל המשתנים, ל- <code class="highlighter-rouge">outer</code> יש גישה ל- <code class="highlighter-rouge">y</code> ו- <code class="highlighter-rouge">x</code>, ולקוד מחוץ לפונקציה (אשר נמצא בתחום הגלובלי) יש גישה ל-<code class="highlighter-rouge">x</code> בלבד.</p>

<h4 id="section">דריסת משתנים</h4>
<p>כאשר מכריזים בתחום המקומי על משתנה עם שם זהה למשתנה אשר קיים מחוץ לתחום, למשתנה המקומי תהיה עדיפות.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">outer</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">inner</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 3</span>
  <span class="p">}</span>

  <span class="nx">inner</span><span class="p">();</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 2</span>
<span class="p">}</span>

<span class="nx">outer</span><span class="p">();</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span> <span class="c1">// 1</span></code></pre></figure>

<p>על מנת למצוא את הערך של a בכל אחד מהתחומים, מנוע JavaScript יתחיל לחפש את הערך בתחום בו המשתנה מבוקש. אם לא ימצא אותו שם הוא ימשיך לתחום שמחוצה לו, עד שיגיע לתחום הגלובלי. אם גם שם המשתנה לא קיים, תתרחש שגיאה.</p>

<h4 id="var">הכרזות ללא <code class="highlighter-rouge">var</code></h4>

<p>מאחר שב- JavaScript ניתן להכריז על משתנים ללא <code class="highlighter-rouge">var</code>, עולה השאלה מה המשמעות של הכרזה שכזו.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">print</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">print</span><span class="p">();</span> <span class="c1">// 2</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">b</span><span class="p">);</span> <span class="c1">// 2</span></code></pre></figure>

<p>כפי שניתן לראות, מאחר ש- <code class="highlighter-rouge">b</code> הוכרז ללא <code class="highlighter-rouge">var</code>, הוא נוצר בתחום הגלובלי, כך שגם הקוד שמחוץ לפונקציה <code class="highlighter-rouge">print</code> יכולה לגשת אליו.
<a href="http://c2.com/cgi/wiki?GlobalVariablesAreBad">כדאי להמנע מכך</a>.<br />
ב- Strict Mode לא ניתן היה לבצע זאת, ושגיאת <code class="highlighter-rouge">ReferenceError</code> תזרק כאשר ננסה להכריז על משתנה ללא <code class="highlighter-rouge">var</code>.</p>

<hr />
<p>במדריך קצר זה למדנו על חוקי ה- Scope ב- JavaScript. הבנת חוקים אלו היא הבסיס לכתיבת קוד JavaScript נכון.<br />
למשתנים מקומיים יש חשיבות רבה בכתיבת תוכניות, מורכבות או פשוטות, ולא היינו רוצים שמשתנים יהיו חשופים למקומות אחרים בקוד שלא צריכים להחשף אליהם.</p>

<p>אבל גם למיקום הגדרת המשתנה יש השפעה על תפקוד הקוד. <strong>אם נגדיר פונקציה בסוף הקוד ונקרא לה בתחילתו, האם JavaScript תאפשר את הפעלת הפונקציה?</strong> (<em>ספויילר: כן</em>)<br />
במדריך הבא נעסוק בדיוק בזה - במה שנהוג לכנות Hoisting.</p>

  </div>
</article>

    </div>

    </div>
  </body>

</html>
